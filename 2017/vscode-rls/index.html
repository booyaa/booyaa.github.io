<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Rust Language Server and Visual Studio Code</title>
<link href='https://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha256-3dkvEK0WLHRJ7/Csr0BZjAWxERc5WH7bdeUya2aXxdU= sha512-+L4yy6FRcDGbXJ9mPG8MT/3UCDzwR9gPeyFNMCtInsol++5m3bk2bXWKdZjvybmohrAsn3Ua5x8gfLnbE1YkOg==" crossorigin="anonymous">
<link rel="stylesheet" href="//writ.cmcenroe.me/1.0.2/writ.min.css">
<link rel="stylesheet" href="/style.css" type="text/css" media="all" />
<link rel="alternate" href="/rss.xml" type="application/rss+xml" title="RSS" />
<meta name="author" content="Mark Sta Ana">
<meta name="description" content="Personal website of Mark Sta Ana, aged 7 3/4."/>
<meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" /> 

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-101141559-1', 'auto');
  ga('send', 'pageview');

</script>

  </head>
<body data-route=blog>
  <nav class="menu">
  <a class="menu-item " href="/about/">booyaa</a>
  <a class="menu-item current" href="/">blog</a>
  <a class="menu-item " href="/talks">talks</a>
  <a class="menu-item" href="/search/">search</a>
  <a class="menu-item" href="/archive/">archive</a>
  <a class="menu-item icon" href="http://github.com/booyaa"><i class="fa fa-github"></i></a>
  <a class="menu-item icon" href="http://twitter.com/booyaa"><i class="fa fa-twitter"></i></a>
  <a class="menu-item icon" href="/rss.xml"><i class="fa fa-rss"></i></a>
  <hr>
</nav>

  <main>
    <article>
      <h1>Rust Language Server and Visual Studio Code</h1>
       
      
      
      								
          
    	 

			<time pubdate="pubdate">Jul 24, 2017 - Reading time: 4 minutes.</time><br />
      
      <p>Click <a href="#tips">here</a> to skip the history lesson and go straight to the tips.</p>
<p>I first heard about the Rust Language Server (RLS), via Phil Dawes' Racer talk
at the <a href="https://www.meetup.com/Rust-London-User-Group/events/229413056/">4th London Rust User
Group</a>.
Immediately I knew the significance of this strategy and how it would reduce
the friction required to get Rust working on the vast array of editors and
IDEs.</p>
<p>This was also around the same time I switched from using vim to Visual Studio
Code as my primary editor. Until code landed, I had to make do with the now
defunct Rusty Code which like all other editor add-ons requires a fair bit of
work to have a coding environment that is Rust savvy.</p>
<p>As soon as RLS alpha came out, I happily gave it a go (along with it's
reference Visual Studio Code extension). Eventually we'd see RLS move into the
rust-lang-nursery repo (where great ideas get incubated) and also become
another rustup component (like src).</p>
<p>I would flit between using the reference extension and Kalita Alexey's fork,
waiting for the day when the reference extension also got added to the <a href="https://marketplace.visualstudio.com/vscode">Visual
Studio Marketplace</a>.</p>
<p>Finally the big day has come and the reference Visual Studio Code extension has
now landed in the Marketplace! So getting Rust to work with Visual Studio Code
is super simplified. In fact I think if you already have a recent version of
rustup, installing the
<a href="https://marketplace.visualstudio.com/items?itemName=rust-lang.rust">extension</a>
will trigger the installation of RLS automatically!</p>
<p><a name="tips"></a>
So you can imagine over time you start to gather a lot of Rust extension leavings...</p>
<p>I'd recommend you go through each of your workspace or user (global) settings
file and remove anything rust related.</p>
<h2>Rusty Code</h2>
<pre style="background-color:#2b303b;">
<span style="background-color:#2b303b;color:#c0c5ce;">{
    &quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.racerPath</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">null</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">// Specifies path to Racer binary if it&#39;s not in PATH
    </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.rustLangSrcPath</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">null</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">// Specifies path to /src directory of local copy of Rust sources
    </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.rustfmtPath</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">null</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">// Specifies path to Rustfmt binary if it&#39;s not in PATH
    </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.rustsymPath</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">null</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">// Specifies path to Rustsym binary if it&#39;s not in PATH
    </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.cargoPath</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">null</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">// Specifies path to Cargo binary if it&#39;s not in PATH
    </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.cargoHomePath</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">null</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">// Path to Cargo home directory, mostly needed for racer. 
                                // Needed only if using custom rust installation.
    </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.cargoEnv</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">null</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">// Specifies custom variables to set when running cargo. Useful for 
                           // crates which use env vars in their build.rs (like openssl-sys).
    </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.formatOnSave</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">false</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">// Turn on/off autoformatting file on save (EXPERIMENTAL)
    </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.checkOnSave</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">false</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">// Turn on/off `cargo check` project on save (EXPERIMENTAL)
    </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.checkWith</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: &quot;</span><span style="background-color:#2b303b;color:#a3be8c;">build</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;, </span><span style="background-color:#2b303b;color:#65737e;">// Specifies the linter to use. (EXPERIMENTAL)
    </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.useJsonErrors</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">false</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">// Enable the use of JSON errors (requires Rust 1.7+). 
                                 // Note: This is an unstable feature of Rust and is still in the process of being stablised
    </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.useNewErrorFormat</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">false</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">// &quot;Use the new Rust error format (RUST_NEW_ERROR_FORMAT=true). 
                                     // Note: This flag is mutually exclusive with `useJsonErrors`.
</span><span style="background-color:#2b303b;color:#c0c5ce;">}
</span></pre>
<h2>Kalita's Rust fork of the reference extension</h2>
<p>I used the RLS integration rather than the legacy setup. The legacy setup
requires you to install rust's friends like rustfmt and racer manually.</p>
<pre style="background-color:#2b303b;">
<span style="background-color:#2b303b;color:#c0c5ce;">{
    &quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.rls</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: {
         &quot;</span><span style="background-color:#2b303b;color:#a3be8c;">executable</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">null</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">// The path to an executable to execute
         </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">args</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">null</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">//  an array of strings. Arguments to pass to the executable
         </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">env</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">null</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">//  An object with the environment to append to the current environment to execute the executable
         </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">revealOutputChannelOn</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">null</span><span style="background-color:#2b303b;color:#c0c5ce;">, </span><span style="background-color:#2b303b;color:#65737e;">// A string. Specifies the condition when the output channel should be revealed
         </span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;</span><span style="background-color:#2b303b;color:#a3be8c;">useRustfmt</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">null </span><span style="background-color:#2b303b;color:#65737e;">// either a boolean or null. Specifies whether rustfmt should be used for formatting
    </span><span style="background-color:#2b303b;color:#c0c5ce;">}
}
</span></pre>
<p>Finally it looks like <code>rls.toml</code> is being deprecated in favour of 
similiary named <code>settings.json</code> parameters.</p>
<p>so </p>
<pre style="background-color:#2b303b;">
<span style="background-color:#2b303b;color:#c0c5ce;">build_lib: false
workspace_mode: true
</span></pre>
<p>becomes</p>
<pre style="background-color:#2b303b;">
<span style="background-color:#2b303b;color:#c0c5ce;">{
    &quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.build_lib</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">false</span><span style="background-color:#2b303b;color:#c0c5ce;">,
    &quot;</span><span style="background-color:#2b303b;color:#a3be8c;">rust.workspace_mode</span><span style="background-color:#2b303b;color:#c0c5ce;">&quot;: </span><span style="background-color:#2b303b;color:#d08770;">true</span><span style="background-color:#2b303b;color:#c0c5ce;">,
}
</span></pre>
    </article>
    <br /><br />
    <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </main>
  <footer>
  <hr>
  <p>
    <a href="/license/">CC BY-SA 4.0 / MIT</a>
    -
    <a href="https://github.com/cobalt-org/cobalt.rs">Built with Cobalt</a>
  </p>
  <br>
</footer>

</body>
</html>
